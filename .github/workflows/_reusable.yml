name: Reusable Deployment Workflow

on:
  workflow_call:
    inputs:
      environment:
        description: 'Deployment environment'
        required: false
        type: string
        default: 'production'

jobs:
  deploy:
    runs-on: ubuntu-latest
    environment: ${{ inputs.environment }}
    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Display deployment info
        run: |
          echo "Deploying application..."
          echo "App Name: ${{ vars.APP_NAME }}"
          echo "App Project: ${{ vars.APP_PROJECT }}"
          echo "Environment: ${{ inputs.environment }}"
          echo "API Key is set: ${{ secrets.APIKEY != '' }}"

      - name: Run deployment script
        env:
          API_KEY: ${{ secrets.APIKEY }}
          APP_NAME: ${{ vars.APP_NAME }}
          APP_PROJECT: ${{ vars.APP_PROJECT }}
        run: |
          echo "Running deployment with the following configuration:"
          echo "APP_NAME: $APP_NAME"
          echo "APP_PROJECT: $APP_PROJECT"
          # Your actual deployment commands would go here
          # curl -H "Authorization: Bearer $API_KEY" ...

      - name: Deployment complete
        run: echo "Deployment completed successfully!"
