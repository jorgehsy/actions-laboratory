name: Reusable Deployment Workflow

on:
  workflow_call:
    inputs:
      app_name:
        description: 'Application name'
        required: true
        type: string
      app_project:
        description: 'Application project'
        required: true
        type: string
      environment:
        description: 'Deployment environment'
        required: false
        type: string
        default: 'production'

jobs:
  deploy:
    runs-on: ubuntu-latest
    environment: ${{ inputs.environment }}
    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Display deployment info
        run: |
          echo "Deploying application..."
          echo "App Name: ${{ inputs.app_name }}"
          echo "App Project: ${{ inputs.app_project }}"
          echo "Environment: ${{ inputs.environment }}"
          echo "API Key is set: ${{ secrets.APIKEY != '' }}"

      - name: Run deployment script
        env:
          API_KEY: ${{ secrets.APIKEY }}
          APP_NAME: ${{ inputs.app_name }}
          APP_PROJECT: ${{ inputs.app_project }}
        run: |
          echo "Running deployment with the following configuration:"
          echo "APP_NAME: $APP_NAME"
          echo "APP_PROJECT: $APP_PROJECT"
          # Your actual deployment commands would go here
          # curl -H "Authorization: Bearer $API_KEY" ...

      - name: Deployment complete
        run: echo "Deployment completed successfully!"
